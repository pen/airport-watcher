#!/bin/sh

sleep 3

SSID=`system_profiler SPAirPortDataType | awk '/Current Network Information:/ { getline; print substr($1, 1, length($1)-1); exit }'`

case "$SSID" in__CASES__
    *) LOCATION='Automatic' ;;
esac

CURRENT=`scselect | awk '/ \*/ { print substr($3, 2, length($3)-2) }'`

if [ "$CURRENT" != "$LOCATION" ]; then
    scselect "$LOCATION"
    echo "airport-watcher.sh: SSID:[$SSID] LOCATION:[$LOCATION] FROM:[$CURRENT]" | logger
fi
